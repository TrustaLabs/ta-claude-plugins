# Interactive Planning（交互式计划制定）

通过交互式多轮对话帮助创建详细、可执行的实施计划。

## 功能特性

- **5层次需求框架**：系统化地挖掘需求全貌（Why/What/How/Constraints/EdgeCases）
- **MoSCoW 范围确认**：明确功能优先级，防止需求跑偏
- **4维度边界情况矩阵**：系统化处理边界情况（数据/网络/并发/权限）
- **高效对话流程**：3-5轮灵活调整，减少反复对话，提高信息密度
- **技术权衡分析**：对比多种技术方案，帮助做出明智决策
- **风险评估**：识别潜在风险并提供缓解措施
- **测试策略**：设计全面的测试方案
- **文档驱动**：自动生成结构化的计划文档

## 安装

```bash
claude-code plugin install ./plugins/interactive-planning
```

## 使用方法

### 方法 1：使用 /ta-plan 命令（推荐）

直接使用 slash command 启动计划制定流程：

```bash
/ta-plan [可选：功能描述]
```

**示例：**
```bash
/ta-plan 添加用户认证功能
/ta-plan 实现深色模式
/ta-plan
```

### 方法 2：自然语言触发 Skill

当你需要制定实施计划时，也可以使用以下任何一种表达方式：

- "帮我制定实现计划"
- "创建开发计划"
- "分析需求并设计方案"
- "评估技术方案"
- "我需要一个详细的实施计划"
- "交互式制定计划"

## 使用流程

### 核心3轮流程（简单功能）

1. **第1轮：需求全貌挖掘（15-20分钟）**
   - 使用5层次框架深度澄清需求（Why/What/How/Constraints/EdgeCases）
   - 使用 MoSCoW 矩阵确认范围（Must/Should/Could/Won't Have）
   - 输出：需求概述 + 范围矩阵

2. **第2轮：方案设计与细化（20-30分钟）**
   - 技术方案评估和权衡
   - 实施步骤分解（具体任务、文件路径、依赖关系）
   - 4维度边界情况矩阵（数据/网络/并发/权限）
   - 输出：技术方案 + 实施步骤 + 边界情况处理

3. **第3轮：风险测试与最终审查（15-20分钟）**
   - 风险评估和缓解措施
   - 测试策略（单元/集成/E2E）
   - 最终完整性检查
   - 输出：完整的实施计划文档

### 扩展5轮流程（复杂功能）

当功能复杂时（多个技术方案、高风险、多模块），可扩展为5轮：
- 第1轮：需求全貌挖掘
- 第2轮：技术方案评估
- 第3轮：实施路径规划
- 第4轮：风险和边界情况
- 第5轮：测试策略与最终审查

### 核心优势

- ✅ 减少对话轮次，提高效率
- ✅ 每轮信息密度高，一次收集更多信息
- ✅ 仅在关键点确认（范围、技术方案、最终审查）

## 输出文档结构

计划文档保存在 `docs/plans/[功能名称]-[时间戳].md`，包含：

1. **需求概述** - 背景、目标、范围、成功标准
2. **技术方案** - 架构、技术选型、数据模型、API 设计
3. **实施步骤** - 分阶段的具体任务，包含文件路径
4. **风险评估** - 识别风险、评估影响、缓解措施
5. **测试策略** - 单元测试、集成测试、E2E 测试
6. **技术权衡** - 方案对比、决策理由
7. **回滚计划** - 回滚条件、步骤、数据备份
8. **后续工作** - 已知限制、未来改进

## 示例

### 示例 1：简单功能（3轮对话）

```
用户：帮我制定一个添加"记住我"功能的计划

Skill：
第1轮：询问功能细节（存储方式、过期时间等）
第2轮：细化实施步骤（修改哪些文件、添加什么代码）
第3轮：最终审查并输出计划
```

### 示例 2：复杂功能（5-7轮对话）

```
用户：我需要实现一个完整的用户认证系统

Skill：
第1轮：澄清需求（支持哪些登录方式、安全要求等）
第2轮：细化方案（分阶段实施、具体任务）
第3轮：技术权衡（JWT vs Session、状态管理方案）
第4轮：补充边缘情况（错误处理、性能优化）
第5轮：最终审查（完整性检查、可执行性验证）
```

## 配置

### 自定义输出目录

默认输出到 `docs/plans/`，可以在使用时指定其他目录。

### 调整对话轮数

Skill 会根据计划复杂度自动调整对话轮数（3-7轮），你也可以在任何时候：
- 要求跳过某些轮次
- 要求增加额外的讨论轮次
- 直接进入最终审查

## 最佳实践

1. **提供充分的上下文** - 越详细的背景信息，计划越准确
2. **积极参与对话** - 认真回答每轮的问题，提供反馈
3. **保存计划文档** - 将计划文档提交到版本控制
4. **定期更新计划** - 实施过程中发现问题时更新计划
5. **参考历史计划** - 查看之前的计划文档作为参考

## 故障排除

### Skill 没有触发

确保你的表达包含关键词：
- "制定计划"、"创建计划"
- "分析需求"、"设计方案"
- "评估方案"、"优化计划"

### 计划文档未生成

检查 `.claude/plans/` 目录是否存在，如果不存在会自动创建。

### 对话轮数不合适

可以明确告诉 Skill：
- "这个功能比较简单，3轮就够了"
- "这个功能很复杂，我们需要更详细的讨论"

## 版本历史

- **v0.2.1** (2024-12-25)
  - ✨ 新增 `/ta-plan` 命令，支持直接调用 skill
  - 📝 更新使用方法，推荐使用 command 方式

- **v0.2.0** (2024-12-25)
  - ✨ 新增5层次需求框架（Why/What/How/Constraints/EdgeCases）
  - ✨ 新增 MoSCoW 范围确认机制，防止需求跑偏
  - ✨ 新增4维度边界情况矩阵（数据/网络/并发/权限）
  - ⚡ 优化对话流程：从固定5轮改为灵活3-5轮
  - ⚡ 提高信息密度，减少反复对话
  - 📝 扩展 references/planning-best-practices.md（新增600+行）
  - 📝 更新 examples/plan-template.md，添加 MoSCoW 章节

- **v0.1.0** (2024-12-24)
  - 初始版本
  - 支持 3-7 轮交互式对话
  - 自动生成结构化计划文档
  - 包含风险评估和测试策略

## 许可证

MIT License

## 贡献

欢迎提出改进建议！请访问 [主仓库](../../README.md) 了解贡献指南。
